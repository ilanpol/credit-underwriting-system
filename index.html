// ×¤×•× ×§×¦×™×™×ª ×“×™×‘×•×’ ××ª×§×“××ª ×œ×§×•×‘×¥ D&B
        function debugDnbFile(workbook) {
            console.log('ğŸ”§ === ×“×™×‘×•×’ ××ª×§×“× ×œ×§×•×‘×¥ D&B ===');
            
            // ×”×¦×’×ª ×›×œ ×”×’×™×œ×™×•× ×•×ª
            console.log('ğŸ“Š ×’×™×œ×™×•× ×•×ª ×‘×§×•×‘×¥:', workbook.SheetNames);
            
            workbook.SheetNames.forEach((sheetName, index) => {
                console.log(`\nğŸ“‹ ×’×™×œ×™×•×Ÿ ${index + 1}: "${sheetName}"`);
                
                const worksheet = workbook.Sheets[sheetName];
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                
                console.log(`   - ××¡×¤×¨ ×©×•×¨×•×ª: ${jsonData.length}`);
                
                // ×”×¦×’×ª 3 ×”×©×•×¨×•×ª ×”×¨××©×•× ×•×ª
                for (let i = 0; i < Math.min(3, jsonData.length); i++) {
                    console.log(`   ×©×•×¨×” ${i + 1}:`, jsonData[i]);
                    
                    // ×—×™×¤×•×© ×¢××•×“×ª "×¡×§×•×¨" ×‘×›×œ ×©×•×¨×”
                    if (jsonData[i]) {
                        const scoreIndex = jsonData[i].findIndex(cell => 
                            cell && cell.toString().trim() === '×¡×§×•×¨'
                        );
                        if (scoreIndex >= 0) {
                            console.log(`   ğŸ¯ × ××¦××” ×¢××•×“×ª "×¡×§×•×¨" ×‘×¢××•×“×” ${scoreIndex + 1} (${String.fromCharCode(65 + scoreIndex)})`);
                            
                            // ×”×¦×’×ª ×”× ×ª×•× ×™× ×‘××•×ª×” ×¢××•×“×” ××”×©×•×¨×•×ª ×”×‘××•×ª
                            for (let j = i + 1; j < Math.min(i + 4, jsonData.length); j++) {
                                const scoreValue = jsonData[j] ? jsonData[j][scoreIndex] : 'undefined';
                                console.log(`   ×¢×¨×š ×¡×§×•×¨ ×‘×©×•×¨×” ${j + 1}:`, scoreValue, `(×¡×•×’: ${typeof scoreValue})`);
                            }
                        }
                    }
                }
                
                // ×‘×“×™×§×” ×× ×–×” ×”×’×™×œ×™×•×Ÿ ×”× ×›×•×Ÿ
                if (sheetName.toLowerCase().includes('scorem') || sheetName === 'scoreM_N') {
                    console.log(`   âœ… ×–×” × ×¨××” ×›××• ×”×’×™×œ×™×•×Ÿ ×”× ×›×•×Ÿ!`);
                }
            });
            
            console.log('ğŸ”§ === ×¡×™×•× ×“×™×‘×•×’ ===\n');
        }

        function processCreditFile(workbook) {
            try {
                console.log('ğŸ¢ ××ª×—×™×œ ×¢×™×‘×•×“ ×§×•×‘×¥ D&B...');
                
                // ×”×¤×¢×œ×ª ×“×™×‘×•×’ ××ª×§×“×
                debugDnbFile(workbook);
                
                console.log('ğŸ“Š ×’×™×œ×™×•× ×•×ª ×–××™× ×™× ×‘×§×•×‘×¥:', workbook.SheetNames);
                
                // ×‘×“×™×§×” ×‘×¡×™×¡×™×ª ×©×™×© ×’×™×œ×™×•× ×•×ª
                if (!workbook.SheetNames || workbook.SheetNames.length === 0) {
                    throw new Error('×œ× × ××¦××• ×’×™×œ×™×•× ×•×ª ×‘×§×•×‘×¥');
                }
                
                // ×—×™×¤×•×© ×¡×¤×¦×™×¤×™ ×œ×’×™×œ×™×•×Ÿ "scoreM_N" - ×—×™×¤×•×© ××“×•×™×§ ×™×•×ª×¨
                let targetSheetName = null;
                
                // ×—×™×¤×•×© ×¨××©×•×Ÿ: ×’×™×œ×™×•×Ÿ ×‘×©× "scoreM_N" ×‘×“×™×•×§
                targetSheetName = workbook.SheetNames.find(name => 
                    name && (name === 'scoreM_N' || name === 'ScoreM_N' || name === 'SCOREM_N')
                );
                
                if (targetSheetName) {
                    console.log(`âœ… × ××¦× ×’×™×œ×™×•×Ÿ scoreM_N: ${targetSheetName}`);
                } else {
                    // ×—×™×¤×•×© ×©× ×™: ×’×™×œ×™×•×Ÿ ×©××›×™×œ "scoreM" ××• "scorem"
                    targetSheetName = workbook.SheetNames.find(name => 
                        name && (name.toLowerCase().includes('scorem') || name.toLowerCase().includes('score_m'))
                    );
                    
                    if (targetSheetName) {
                        console.log(`âœ… × ××¦× ×’×™×œ×™×•×Ÿ ×“×•××” ×œ-scoreM_N: ${targetSheetName}`);
                    } else {
                        // ×—×™×¤×•×© ×©×œ×™×©×™: ×’×™×œ×™×•×Ÿ ×©××›×™×œ "score"
                        targetSheetName = workbook.SheetNames.find(name => 
                            name && name.toLowerCase().includes('score')
                        );
                        
                        if (targetSheetName) {
                            console.log(`âœ… × ××¦× ×’×™×œ×™×•×Ÿ ×¢× "score": ${targetSheetName}`);
                        } else {
                            // ×× ×œ× ××¦×× ×•, ×§×— ××ª ×”×’×™×œ×™×•×Ÿ ×”×¨××©×•×Ÿ
                            targetSheetName = workbook.SheetNames[0];
                            console.log(`âš ï¸ ×œ× × ××¦× ×’×™×œ×™×•×Ÿ ××ª××™×, ××©×ª××© ×‘×¨××©×•×Ÿ: "${targetSheetName}"`);
                        }
                    }
                }
                
                // ×‘×“×™×§×” ×©×™×© ×œ× ×• ×’×™×œ×™×•×Ÿ ×ª×§×™×Ÿ
                if (!targetSheetName) {
                    throw new Error('×œ× × ××¦× ×’×™×œ×™×•×Ÿ ×ª×§×™×Ÿ ×œ×¢×™×‘×•×“');
                }
                
                console.log(`ğŸ¯ ×’×™×œ×™×•×Ÿ × ×‘×—×¨ ×œ×¢×™×‘×•×“: "${targetSheetName}"`);
                
                const worksheet = workbook.Sheets[targetSheetName];
                if (!worksheet) {
                    throw new Error(`×’×™×œ×™×•×Ÿ "${targetSheetName}" ×œ× ×§×™×™× ××• ×¨×™×§`);
                }
                
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                
                if (!jsonData || jsonData.length === 0) {
                    throw new Error(`×’×™×œ×™×•×Ÿ "${targetSheetName}" ×¨×™×§ ××• ×œ× ××›×™×œ × ×ª×•× ×™×`);
                }
                
                console.log(`ğŸ“Š × ×ª×•× ×™ ×’×™×œ×™×•×Ÿ "${targetSheetName}" (${jsonData.length} ×©×•×¨×•×ª ×¡×”"×›):`);
                console.log('ğŸ” ××¦×™×’ 5 ×©×•×¨×•×ª ×¨××©×•× ×•×ª:');
                for (let i = 0; i < Math.min(5, jsonData.length); i++) {
                    console.log(`×©×•×¨×” ${i + 1}:`, jsonData[i]);
                }
                
                // ×—×™×¤×•×© ×ª×—×™×œ×ª ×”×˜×‘×œ×” - ×—×™×¤×•×© ××©×•×¤×¨
                let tableStartRow = -1;
                
                console.log('ğŸ” ××—×¤×© ×©×•×¨×ª ×›×•×ª×¨×•×ª...');
                
                // ×—×™×¤×•×© ×©×•×¨×” ×©××›×™×œ×” ××ª ×”×›×•×ª×¨×•×ª - ×—×™×¤×•×© ×’××™×© ×™×•×ª×¨
                for (let i = 0; i < Math.min(10, jsonData.length); i++) {
                    const row = jsonData[i];
                    if (!row || row.length < 5) continue;
                    
                    // ×—×™×¤×•×© ×”×›×•×ª×¨×ª "×¡×§×•×¨" - ×–×• ×”×›×•×ª×¨×ª ×”×§×¨×™×˜×™×ª
                    const scoreColumnIndex = row.findIndex(cell => 
                        cell && cell.toString().trim() === '×¡×§×•×¨'
                    );
                    
                    if (scoreColumnIndex >= 0) {
                        tableStartRow = i;
                        console.log(`âœ… × ××¦××ª ×©×•×¨×ª ×›×•×ª×¨×•×ª ×‘×©×•×¨×” ${i + 1} - ×¢××•×“×ª "×¡×§×•×¨" ×‘××™× ×“×§×¡ ${scoreColumnIndex} (×¢××•×“×” ${String.fromCharCode(65 + scoreColumnIndex)})`);
                        console.log(`ğŸ“‹ ×›×•×ª×¨×•×ª ××œ××•×ª:`, row);
                        
                        // ×”×¦×’×ª ×“×•×’××” ××”× ×ª×•× ×™× ××ª×—×ª ×œ×›×•×ª×¨×ª
                        console.log('ğŸ” ×“×•×’×××•×ª ×¢×¨×›×™ ×¡×§×•×¨:');
                        for (let j = i + 1; j < Math.min(i + 4, jsonData.length); j++) {
                            const scoreValue = jsonData[j] ? jsonData[j][scoreColumnIndex] : 'undefined';
                            const companyName = jsonData[j] ? jsonData[j][0] : 'unknown'; // × × ×™×— ×©×”×©× ×‘×¢××•×“×” ×”×¨××©×•× ×”
                            console.log(`  ×©×•×¨×” ${j + 1}: ×—×‘×¨×”="${companyName}", ×¡×§×•×¨="${scoreValue}" (×¡×•×’: ${typeof scoreValue})`);
                        }
                        
                        break;
                    }
                    
                    // ×—×™×¤×•×© ×—×œ×•×¤×™ - ×—×™×¤×•×© ×›×•×ª×¨×•×ª × ×•×¡×¤×•×ª
                    const hasPayerName = row.some(cell => cell && (
                        cell.toString().includes('×©× ××•×©×š') || 
                        cell.toString().includes('×©× ×—×‘×¨×”') ||
                        cell.toString().includes('×©× ×”××•×©×š')
                    ));
                    
                    const hasPayerId = row.some(cell => cell && (
                        cell.toString().includes('××¡\' ×—.×¤') ||
                        cell.toString().includes('×—.×¤') ||
                        cell.toString().includes('××–×”×”')
                    ));
                    
                    const hasScore = row.some(cell => cell && (
                        cell.toString().trim() === '×¡×§×•×¨' ||
                        cell.toString().includes('×“×™×¨×•×’') ||
                        cell.toString().includes('×¦×™×•×Ÿ')
                    ));
                    
                    if (hasPayerName && hasPayerId && hasScore) {
                        tableStartRow = i;
                        console.log(`âœ… × ××¦××ª ×©×•×¨×ª ×›×•×ª×¨×•×ª ×—×œ×•×¤×™×ª ×‘×©×•×¨×” ${i + 1}`);
                        console.log(`ğŸ“‹ ×›×•×ª×¨×•×ª:`, row);
                        break;
                    }
                }
                
                // ×× ×œ× ××¦×× ×• ×›×•×ª×¨×•×ª, × ×©×ª××© ×‘×©×•×¨×” ×”×¨××©×•× ×”
                if (tableStartRow === -1) {
                    console.log('ğŸ” ×œ× × ××¦××• ×›×•×ª×¨×•×ª ×‘×¨×•×¨×•×ª, ×‘×•×“×§ ××ª ×”×©×•×¨×” ×”×¨××©×•× ×”...');
                    const firstRow = jsonData[0];
                    if (firstRow && firstRow.length >= 5) {
                        // ×‘×“×•×§ ×× ×™×© ×¢××•×“×” ×¢× "×¡×§×•×¨"
                        const hasScoreColumn = firstRow.some(cell => 
                            cell && cell.toString().trim() === '×¡×§×•×¨'
                        );
                        
                        if (hasScoreColumn) {
                            tableStartRow = 0;
                            console.log(`âœ… × ××¦××” ×¢××•×“×ª "×¡×§×•×¨" ×‘×©×•×¨×” ×”×¨××©×•× ×”`);
                        } else {
                            // ×›××¤×©×¨×•×ª ××—×¨×•× ×” - ×©×•×¨×” ×”×¨××©×•× ×”
                            tableStartRow = 0;
                            console.log('âš ï¸ ××©×ª××© ×‘×©×•×¨×” ×”×¨××©×•× ×” ×›×‘×¨×™×¨×ª ××—×“×œ');
                        }
                    } else {
                        throw new Error('×œ× × ××¦××• ×›×•×ª×¨×•×ª ×ª×§×™× ×•×ª ×‘×’×™×œ×™×•×Ÿ');
                    }
                }
                
                console.log(`ğŸ“Š ××ª×—×™×œ ×¢×™×‘×•×“ ××”×©×•×¨×” ${tableStartRow + 1}`);
                
                // ×—×™×œ×•×¥ ×”×˜×‘×œ×” ××”×©×•×¨×” ×”××ª××™××”
                const tableData = jsonData.slice(tableStartRow);
                
                if (tableData.length <= 1) {
                    throw new Error(`×˜×‘×œ×” ×‘×’×™×œ×™×•×Ÿ "${targetSheetName}" ×¨×™×§×” ××• ××›×™×œ×” ×¨×§ ×›×•×ª×¨×•×ª`);
                }
                
                console.log(`ğŸ“Š × ×ª×•× ×™ ×˜×‘×œ×” ×œ×¢×™×‘×•×“: ${tableData.length} ×©×•×¨×•×ª (×›×•×œ×œ ×›×•×ª×¨×•×ª)`);
                console.log('ğŸ“‹ ×›×•×ª×¨×•×ª ×©×™×¢×•×‘×“×•:', tableData[0]);
                if (tableData[1]) {
                    console.log('ğŸ“‹ ×“×•×’××” ×œ× ×ª×•× ×™× (×©×•×¨×” 2):', tableData[1]);
                }
                
                // ×‘×“×™×§×” ×©×™×© ×¢××•×“×ª "×¡×§×•×¨"
                const headers = tableData[0];
                const scoreColumnIndex = headers ? headers.findIndex(cell => 
                    cell && cell.toString().trim() === '×¡×§×•×¨'
                ) : -1;
                
                if (scoreColumnIndex === -1) {
                    console.warn('âš ï¸ ×œ× × ××¦××” ×¢××•×“×ª "×¡×§×•×¨" ×‘×›×•×ª×¨×•×ª');
                    console.log('ğŸ” ×›×•×ª×¨×•×ª ×–××™× ×•×ª:', headers.map((h, i) => `${String.fromCharCode(65 + i)}:${h}`));
                } else {
                    console.log(`âœ… ×¢××•×“×ª "×¡×§×•×¨" × ××¦××” ×‘××™× ×“×§×¡ ${scoreColumnIndex} (×¢××•×“×” ${String.fromCharCode(65 + scoreColumnIndex)})`);
                }
                
                excelData.credit = tableData;
                processDnbData();
                
                const dataRowsCount = tableData.length - 1;
                console.log(`ğŸ¢ ×”×•×©×œ× ×¢×™×‘×•×“ ×˜×‘×œ×ª scoreM_N ××’×™×œ×™×•×Ÿ "${targetSheetName}": ${dataRowsCount} ×—×‘×¨×•×ª`);
                showNotification(`âœ… × ×˜×¢× ×” ×˜×‘×œ×ª D&B ××’×™×œ×™×•×Ÿ "${targetSheetName}" - ${dataRowsCount} ×—×‘×¨×•×ª`, 'success');
                
            } catch (error) {
                console.error('âŒ ×©×’×™××” ×‘×¢×™×‘×•×“ ×§×•×‘×¥ D&B:', error);
                showNotification('âŒ ×©×’×™××” ×‘×¢×™×‘×•×“ ×§×•×‘×¥ D&B: ' + error.message, 'error');
                
                // ×”×¦×’×ª ××™×“×¢ × ×•×¡×£ ×œ×“×™×‘×•×’
                console.log('ğŸ”§ ××™×“×¢ × ×•×¡×£ ×œ×“×™×‘×•×’:');
                console.log('- × ×“×¨×© ×§×•×‘×¥ Excel ×¢× ×’×™×œ×™×•×Ÿ ×‘×©× "scoreM_N"');
                console.log('- ×‘×’×™×œ×™×•×Ÿ ×¦×¨×™×›×” ×œ×”×™×•×ª ×¢××•×“×” ×‘×©× "×¡×§×•×¨"');
                console.log('- ×’×™×œ×™×•× ×•×ª ×–××™× ×™× ×‘×§×•×‘×¥:', workbook.SheetNames);
                if (workbook.SheetNames && workbook.SheetNames.length > 0) {
                    console.log('- ×’×™×œ×™×•×Ÿ ×¨××©×•×Ÿ ×‘×§×•×‘×¥:', workbook.SheetNames[0]);
                    
                    // ×‘×“×™×§×” ××”×™×¨×” ×©×œ ×”×’×™×œ×™×•×Ÿ ×”×¨××©×•×Ÿ
                    try {
                        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                        const firstSheetData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                        if (firstSheetData[0]) {
                            console.log('- ×›×•×ª×¨×•×ª ×‘×’×™×œ×™×•×Ÿ ×”×¨××©×•×Ÿ:', firstSheetData[0].map((h, i) => `${String.fromCharCode(65 + i)}:${h}`));
                        }
                    } catch (debugError) {
                        console.log('- ×œ× × ×™×ª×Ÿ ×œ×§×¨×•× ××ª ×”×’×™×œ×™×•×Ÿ ×”×¨××©×•×Ÿ');
                    }
                }
                
                throw error;
            }
        }
