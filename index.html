<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××¢×¨×›×ª ×—×™×ª×•× ××©×¨××™ - ×§×‘×¦×™× ×××™×ª×™×™×</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/papaparse/5.4.1/papaparse.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; direction: rtl; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header { background: rgba(255, 255, 255, 0.95); padding: 30px; border-radius: 20px; text-align: center; margin-bottom: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); }
        .header h1 { color: #2c3e50; font-size: 2.5em; margin-bottom: 10px; }
        .header p { color: #7f8c8d; font-size: 1.2em; }
        .main-content { display: grid; grid-template-columns: 1fr 2fr; gap: 30px; margin-bottom: 30px; }
        .input-section, .results-section { background: rgba(255, 255, 255, 0.95); padding: 30px; border-radius: 20px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); }
        .results-section { display: none; }
        .form-group { margin-bottom: 25px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #34495e; font-size: 14px; }
        input, select { width: 100%; padding: 12px 15px; border: 2px solid #e1e8ed; border-radius: 10px; font-size: 16px; transition: all 0.3s ease; }
        input:focus, select:focus { outline: none; border-color: #3498db; box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1); }
        .autocomplete-container { position: relative; }
        .autocomplete-suggestions { position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #e1e8ed; border-top: none; border-radius: 0 0 10px 10px; max-height: 200px; overflow-y: auto; z-index: 1000; display: none; }
        .autocomplete-suggestion { padding: 12px 15px; cursor: pointer; border-bottom: 1px solid #f8f9fa; }
        .autocomplete-suggestion:hover { background: #f8f9fa; }
        .suggestion-name { font-weight: 600; color: #2c3e50; }
        .suggestion-id { font-size: 12px; color: #7f8c8d; margin-top: 2px; }
        .suggestion-details { font-size: 11px; color: #95a5a6; margin-top: 2px; }
        .btn { background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 15px 30px; border: none; border-radius: 50px; font-size: 18px; font-weight: 600; cursor: pointer; width: 100%; transition: all 0.3s ease; margin-top: 20px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4); }
        .btn:disabled { background: #bdc3c7; cursor: not-allowed; transform: none; box-shadow: none; }
        .rating-display { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .rating-card { background: white; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); }
        .rating-score { font-size: 3em; font-weight: bold; margin-bottom: 10px; }
        .rating-D { color: #e74c3c; } .rating-CCC { color: #e67e22; } .rating-B { color: #f39c12; } .rating-BB { color: #f1c40f; } .rating-BBB { color: #f39c12; } .rating-A { color: #27ae60; } .rating-AA { color: #2ecc71; } .rating-AAA { color: #27ae60; }
        .details-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .detail-card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); }
        .detail-card h3 { color: #2c3e50; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #ecf0f1; }
        .detail-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 14px; }
        .detail-label { color: #7f8c8d; } .detail-value { font-weight: 600; color: #2c3e50; }
        .parameters-section { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); margin-bottom: 20px; }
        .parameter-item { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 15px; padding: 15px; border-bottom: 1px solid #ecf0f1; align-items: center; }
        .parameter-item:last-child { border-bottom: none; }
        .parameter-name { font-weight: 600; color: #2c3e50; }
        .parameter-reason { font-size: 12px; color: #7f8c8d; margin-top: 5px; }
        .status-badge { padding: 4px 8px; border-radius: 20px; font-size: 11px; font-weight: 600; text-align: center; }
        .status-positive { background: #d5f4e6; color: #27ae60; } .status-negative { background: #fadbd8; color: #e74c3c; } .status-neutral { background: #eaecee; color: #7f8c8d; } .status-missing { background: #fdf2e9; color: #e67e22; }
        .recommendation { background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; padding: 25px; border-radius: 15px; text-align: center; margin: 20px 0; font-size: 1.2em; font-weight: 600; }
        .recommendation.positive { background: linear-gradient(135deg, #27ae60, #229954); }
        .recommendation.warning { background: linear-gradient(135deg, #f39c12, #e67e22); }
        .file-upload { background: #f8f9fa; border: 2px dashed #dee2e6; border-radius: 10px; padding: 20px; text-align: center; margin-bottom: 20px; transition: all 0.3s ease; }
        .file-upload:hover { border-color: #3498db; background: #f0f8ff; }
        .file-upload input { display: none; }
        .file-upload label { cursor: pointer; color: #3498db; font-weight: 600; }
        .data-status { background: #f8f9fa; border-radius: 10px; padding: 15px; margin-bottom: 20px; }
        .data-status h3 { color: #2c3e50; margin-bottom: 10px; }
        .data-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #ecf0f1; }
        .data-item:last-child { border-bottom: none; }
        .data-item-name { color: #34495e; font-weight: 500; }
        .data-item-status { padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; }
        .status-loaded { background: #d5f4e6; color: #27ae60; } .status-missing { background: #fadbd8; color: #e74c3c; }
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .progress-bar { background: #ecf0f1; border-radius: 10px; overflow: hidden; margin-top: 10px; }
        .progress-fill { background: #3498db; height: 10px; transition: width 0.3s ease; }
        .file-info { background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; padding: 10px; margin-top: 10px; }
        .file-info h4 { color: #2e7d2e; margin-bottom: 5px; }
        .file-info ul { margin: 0; padding-right: 20px; }
        .file-info li { color: #2e7d2e; font-size: 12px; margin-bottom: 3px; }
        @media (max-width: 768px) { .main-content { grid-template-columns: 1fr; } .details-grid { grid-template-columns: 1fr; } .rating-display { grid-template-columns: 1fr; } .parameter-item { grid-template-columns: 1fr; gap: 5px; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¦ ××¢×¨×›×ª ×—×™×ª×•× ××©×¨××™ ××ª×§×“××ª</h1>
            <p>×”×¢×¨×›×ª ×¡×™×›×•× ×™× ×•×—×™×©×•×‘ ×“×™×¨×•×’ ××©×¨××™ ×¢×œ ×‘×¡×™×¡ × ×ª×•× ×™× ×××™×ª×™×™×</p>
        </div>

        <div class="main-content">
            <div class="input-section">
                <h2 style="margin-bottom: 25px; color: #2c3e50;">×¤×¨×˜×™ ×”×©×™×§ ×•×”××•×©×š</h2>
                
                <div class="data-status" id="dataStatus">
                    <h3>×¡×˜×˜×•×¡ ×§×‘×¦×™ × ×ª×•× ×™×</h3>
                    <div class="data-item">
                        <span class="data-item-name">×’×™×œ×™×•×Ÿ ×¢×¡×§××•×ª</span>
                        <span class="data-item-status status-missing" id="status-transactions">×œ× × ×˜×¢×Ÿ</span>
                    </div>
                    <div class="data-item">
                        <span class="data-item-name">× ×ª×•× ×™ ××•×©×›×™×</span>
                        <span class="data-item-status status-loaded" id="status-payers">4 ××•×©×›×™× (×“×•×’××”)</span>
                    </div>
                    <div class="data-item">
                        <span class="data-item-name">× ×ª×•× ×™ ×œ×§×•×—×•×ª</span>
                        <span class="data-item-status status-loaded" id="status-customers">4 ×œ×§×•×—×•×ª (×“×•×’××”)</span>
                    </div>
                    <div class="data-item">
                        <span class="data-item-name">× ×ª×•× ×™ D&B</span>
                        <span class="data-item-status status-missing" id="status-db">×œ× × ×˜×¢×Ÿ</span>
                    </div>
                    <div class="data-item">
                        <span class="data-item-name">×©×™×§×™× ×—×•×–×¨×™×</span>
                        <span class="data-item-status status-missing" id="status-returned">×œ× × ×˜×¢×Ÿ</span>
                    </div>
                </div>

                <div class="file-upload" id="fileUploadArea">
                    <label for="dataFiles">ğŸ“ ×”×¢×œ×” ×§×‘×¦×™ × ×ª×•× ×™× (Excel/CSV)</label>
                    <input type="file" id="dataFiles" multiple accept=".xlsx,.xls,.csv">
                    <p style="margin-top: 10px; font-size: 12px; color: #7f8c8d;">
                        ×§×‘×¦×™× × ×“×¨×©×™×: ×›×œ×”× ×ª×•× ×™×6.11.22.xlsx, ×—×™×ª×•× ××©×¨××™.xlsx, ×§×‘×¦×™ ×©×™×§×™× ×—×•×–×¨×™×
                    </p>
                    <div id="uploadProgress" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                        </div>
                        <p id="uploadStatus" style="margin-top: 5px; font-size: 12px; color: #7f8c8d;"></p>
                    </div>
                </div>

                <div id="fileResults" style="display: none;"></div>
                
                <div class="form-group">
                    <label for="payerName">×©× ××•×©×š</label>
                    <div class="autocomplete-container">
                        <input type="text" id="payerName" placeholder="×”×ª×—×œ ×œ×”×§×œ×™×“ ×©× ××•×©×š..." autocomplete="off">
                        <div id="payerSuggestions" class="autocomplete-suggestions"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="payerID">×—.×¤./×¢.×. ××•×©×š</label>
                    <input type="text" id="payerID" placeholder="×™×ª××œ× ××•×˜×•××˜×™" readonly style="background: #f8f9fa;">
                </div>

                <div class="form-group">
                    <label for="customerName">×©× ×œ×§×•×—</label>
                    <div class="autocomplete-container">
                        <input type="text" id="customerName" placeholder="×”×ª×—×œ ×œ×”×§×œ×™×“ ×©× ×œ×§×•×—..." autocomplete="off">
                        <div id="customerSuggestions" class="autocomplete-suggestions"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="customerID">×—.×¤./×¢.×. ×œ×§×•×—</label>
                    <input type="text" id="customerID" placeholder="×™×ª××œ× ××•×˜×•××˜×™" readonly style="background: #f8f9fa;">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="checkAmount">×¡×›×•× ×”×©×™×§</label>
                        <input type="number" id="checkAmount" placeholder="×¡×›×•× ×‘×©×´×—">
                    </div>
                    <div class="form-group">
                        <label for="paymentDate">×ª××¨×™×š ×¤×™×¨×¢×•×Ÿ</label>
                        <input type="date" id="paymentDate">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="bankCode">×‘× ×§</label>
                        <input type="text" id="bankCode" placeholder="×§×•×“ ×‘× ×§">
                    </div>
                    <div class="form-group">
                        <label for="branchCode">×¡× ×™×£</label>
                        <input type="text" id="branchCode" placeholder="×§×•×“ ×¡× ×™×£">
                    </div>
                </div>

                <button class="btn" onclick="calculateRating()" id="calculateBtn">ğŸ§® ×—×©×‘ ×“×™×¨×•×’ ××©×¨××™ ××ª×§×“×</button>
                <button class="btn" style="background: #95a5a6; margin-top: 10px;" onclick="loadExample()">ğŸ“‹ ×˜×¢×Ÿ ×“×•×’××” ××”×™×¨×”</button>
            </div>

            <div class="results-section" id="resultsSection">
                <div class="rating-display" id="ratingDisplay"></div>
                <div class="details-grid" id="detailsGrid"></div>
                <div class="parameters-section">
                    <h3 style="margin-bottom: 20px; color: #2c3e50;">×¤×™×¨×•×˜ ×¤×¨××˜×¨×™ ×”×“×™×¨×•×’</h3>
                    <div id="parametersGrid"></div>
                </div>
                <div id="recommendation" class="recommendation"></div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" style="width: auto; margin-right: 10px;" onclick="window.print()">ğŸ–¨ï¸ ×”×“×¤×¡ ×“×•×—</button>
                    <button class="btn" style="width: auto; background: #95a5a6;" onclick="resetForm()">ğŸ”„ ×¢×¡×§×” ×—×“×©×”</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ××©×ª× ×™× ×’×œ×•×‘×œ×™×™× ×œ× ×ª×•× ×™×
        let transactionsData = [];
        let payersData = [
            { name: '×”×“×¨ ×‘× ×™×” ××—×–×§×”', id: '200353902', transactions: 0, dbScore: 38.704, sectorScore: 29, returnedChecks: 0, totalAmount: 0 },
            { name: '××™×‘×¨×”×™× ×¨××‘×™', id: '305346900', transactions: 0, dbScore: 45.2, sectorScore: 32, returnedChecks: 0, totalAmount: 0 },
            { name: '×—×‘×¨×ª ×”×‘× ×™×™×” ×”×’×“×•×œ×”', id: '123456789', transactions: 15, dbScore: 72.5, sectorScore: 65, returnedChecks: 1, totalAmount: 750000 },
            { name: '××©×” ×›×”×Ÿ', id: '987654321', transactions: 8, dbScore: 55.8, sectorScore: 50, returnedChecks: 0, totalAmount: 320000 }
        ];
        let customersData = [
            { name: '××™×‘×¨×”×™× ×¨××‘×™', id: '305346900', transactions: 0, totalAmount: 0 },
            { name: '×©×¨×” ×œ×•×™', id: '123456788', transactions: 2, totalAmount: 85000 },
            { name: '×“×•×“ ×™×©×¨××œ×™', id: '111222333', transactions: 5, totalAmount: 210000 },
            { name: '××™×¨×‘ ×¤×•×œ×§', id: '444555666', transactions: 1, totalAmount: 45000 }
        ];
        let dbData = [];
        let returnedChecksData = [];
        let banksData = [];

        function initializeSystem() {
            setupAutocomplete();
            setupFileUpload();
        }

        function setupFileUpload() {
            document.getElementById('dataFiles').addEventListener('change', handleFileUpload);
        }

        async function handleFileUpload(event) {
            const files = event.target.files;
            if (files.length === 0) return;

            const uploadProgress = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            const uploadStatus = document.getElementById('uploadStatus');
            const fileResults = document.getElementById('fileResults');

            uploadProgress.style.display = 'block';
            fileResults.style.display = 'none';

            let processedFiles = 0;
            const totalFiles = files.length;
            let results = [];

            for (let file of files) {
                try {
                    uploadStatus.textContent = `××¢×‘×“ ×§×•×‘×¥: ${file.name}`;
                    
                    const result = await processFile(file);
                    results.push(result);
                    
                    processedFiles++;
                    const progress = (processedFiles / totalFiles) * 100;
                    progressFill.style.width = progress + '%';
                    
                } catch (error) {
                    console.error('×©×’×™××” ×‘×¢×™×‘×•×“ ×§×•×‘×¥:', file.name, error);
                    results.push({
                        fileName: file.name,
                        status: 'error',
                        message: `×©×’×™××”: ${error.message}`
                    });
                }
            }

            uploadProgress.style.display = 'none';
            displayFileResults(results);
            updateDataStatus();
            refreshAutocomplete();
        }

        async function processFile(file) {
            return new Promise((resolve, reject) => {
                const fileName = file.name.toLowerCase();
                const reader = new FileReader();

                reader.onload = function(e) {
                    try {
                        let result = { fileName: file.name, status: 'success', data: [] };

                        if (fileName.endsWith('.csv')) {
                            // ×¢×™×‘×•×“ CSV
                            const text = e.target.result;
                            const parsed = Papa.parse(text, { 
                                header: true, 
                                skipEmptyLines: true,
                                encoding: 'UTF-8'
                            });
                            result.data = parsed.data;
                            result.rows = parsed.data.length;
                            result.type = 'CSV';
                        } else {
                            // ×¢×™×‘×•×“ Excel
                            const data = new Uint8Array(e.target.result);
                            const workbook = XLSX.read(data, { type: 'array' });
                            const firstSheetName = workbook.SheetNames[0];
                            const worksheet = workbook.Sheets[firstSheetName];
                            const jsonData = XLSX.utils.sheet_to_json(worksheet);
                            
                            result.data = jsonData;
                            result.rows = jsonData.length;
                            result.type = 'Excel';
                            result.sheets = workbook.SheetNames;
                        }

                        // ×–×™×”×•×™ ×¡×•×’ ×”×§×•×‘×¥ ×•×¢×™×‘×•×“ ××ª××™×
                        if (fileName.includes('×›×œ×”× ×ª×•× ×™×') || fileName.includes('×’×™×œ×™×•×Ÿ')) {
                            processTransactionsData(result.data);
                            result.description = '× ×ª×•× ×™ ×¢×¡×§××•×ª';
                            updateDataStatus('transactions', `${result.rows} ×¢×¡×§××•×ª`);
                        } 
                        else if (fileName.includes('×—×™×ª×•×') || fileName.includes('score')) {
                            processDBData(result.data);
                            result.description = '× ×ª×•× ×™ D&B';
                            updateDataStatus('db', `${result.rows} ×¨×©×•××•×ª`);
                        }
                        else if (fileName.includes('×—×•×–×¨')) {
                            returnedChecksData = result.data;
                            result.description = '×©×™×§×™× ×—×•×–×¨×™×';
                            updateDataStatus('returned', `${result.rows} ×©×™×§×™×`);
                        }
                        else {
                            result.description = '×§×•×‘×¥ ×›×œ×œ×™';
                        }

                        resolve(result);
                    } catch (error) {
                        reject(error);
                    }
                };

                reader.onerror = () => reject(new Error('×©×’×™××” ×‘×§×¨×™××ª ×”×§×•×‘×¥'));

                if (fileName.endsWith('.csv')) {
                    reader.readAsText(file, 'UTF-8');
                } else {
                    reader.readAsArrayBuffer(file);
                }
            });
        }

        function processTransactionsData(data) {
            transactionsData = data;
            
            // ×¢×“×›×•×Ÿ × ×ª×•× ×™ ××•×©×›×™× ×•×œ×§×•×—×•×ª ××”× ×ª×•× ×™× ×”×××™×ª×™×™×
            const payersMap = new Map();
            const customersMap = new Map();

            data.forEach(row => {
                // ×¢×™×‘×•×“ ××•×©×›×™×
                const payerName = row['×©× ××•×©×š'] || row['×©×_××•×©×š'] || row['payer_name'];
                const payerID = row['××¡×¤×¨ ×–×”×•×ª ××•×©×š'] || row['××¡×¤×¨_×–×”×•×ª_××•×©×š'] || row['payer_id'];
                const amount = parseFloat(row['×¡×›×•×'] || row['amount']) || 0;

                if (payerName && payerID) {
                    if (!payersMap.has(payerID)) {
                        payersMap.set(payerID, {
                            name: payerName,
                            id: payerID,
                            transactions: 0,
                            totalAmount: 0,
                            returnedChecks: 0,
                            dbScore: 50,
                            sectorScore: 45
                        });
                    }
                    const payer = payersMap.get(payerID);
                    payer.transactions++;
                    payer.totalAmount += amount;
                }

                // ×¢×™×‘×•×“ ×œ×§×•×—×•×ª
                const customerName = row['×©× ×œ×§×•×—'] || row['×©×_×œ×§×•×—'] || row['customer_name'];
                const customerID = row['×.×–×”×•×ª'] || row['××–×”×•×ª'] || row['customer_id'];

                if (customerName && customerID) {
                    if (!customersMap.has(customerID)) {
                        customersMap.set(customerID, {
                            name: customerName,
                            id: customerID,
                            transactions: 0,
                            totalAmount: 0
                        });
                    }
                    const customer = customersMap.get(customerID);
                    customer.transactions++;
                    customer.totalAmount += amount;
                }
            });

            // ×”××¨×” ×œ××¢×¨×›×™×
            payersData = Array.from(payersMap.values());
            customersData = Array.from(customersMap.values());

            updateDataStatus('payers', `${payersData.length} ××•×©×›×™×`);
            updateDataStatus('customers', `${customersData.length} ×œ×§×•×—×•×ª`);
        }

        function processDBData(data) {
            dbData = data;
            
            // ×¢×“×›×•×Ÿ ×¦×™×•× ×™ D&B ×œ××•×©×›×™× ×§×™×™××™×
            payersData.forEach(payer => {
                const dbRecord = data.find(record => 
                    record['××¡\' ×—.×¤'] === payer.id || 
                    record['××¡×¤×¨_×–×”×•×ª'] === payer.id ||
                    record['id'] === payer.id
                );
                
                if (dbRecord) {
                    payer.dbScore = parseFloat(dbRecord['×¡×§×•×¨'] || dbRecord['score']) || payer.dbScore;
                    payer.sectorScore = parseFloat(dbRecord['×¡×§×•×¨ ×¢× ×£'] || dbRecord['sector_score']) || payer.sectorScore;
                    payer.companyAge = parseInt(dbRecord['×©× ×•×ª ×•×ª×§'] || dbRecord['years']) || 0;
                    payer.employeeCount = parseInt(dbRecord['××¡\' ××•×¢×¡×§×™×'] || dbRecord['employees']) || 0;
                    payer.annualTurnover = parseFloat(dbRecord['××—×–×•×¨ ×‘×\' â‚ª'] || dbRecord['turnover']) || 0;
                }
            });
        }

        function displayFileResults(results) {
            const fileResults = document.getElementById('fileResults');
            
            let html = '<div class="file-info"><h4>×§×‘×¦×™× ×©×¢×•×‘×“×• ×‘×”×¦×œ×—×”:</h4><ul>';
            
            results.forEach(result => {
                if (result.status === 'success') {
                    html += `<li>${result.fileName} - ${result.description} (${result.rows} ×©×•×¨×•×ª)</li>`;
                } else {
                    html += `<li style="color: #e74c3c;">${result.fileName} - ${result.message}</li>`;
                }
            });
            
            html += '</ul></div>';
            fileResults.innerHTML = html;
            fileResults.style.display = 'block';
        }

        function updateDataStatus(type, status) {
            const statusElement = document.getElementById(`status-${type}`);
            if (statusElement) {
                statusElement.textContent = status;
                statusElement.className = 'data-item-status status-loaded';
            }
        }

        function setupAutocomplete() {
            document.getElementById('payerName').addEventListener('input', (e) => showSuggestions(e, 'payers'));
            document.getElementById('customerName').addEventListener('input', (e) => showSuggestions(e, 'customers'));
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.autocomplete-container')) {
                    hideSuggestions();
                }
            });
        }

        // ×’×¨×¡×” × ×•×¡×¤×ª ×¢× event listeners ×‘××§×•× onclick
        function showSuggestions(event, type) {
            const input = event.target;
            const query = input.value.toLowerCase();
            const suggestionsId = type === 'payers' ? 'payerSuggestions' : 'customerSuggestions';
            const suggestionsContainer = document.getElementById(suggestionsId);
            
            if (query.length < 2) {
                suggestionsContainer.style.display = 'none';
                return;
            }
            
            const data = type === 'payers' ? payersData : customersData;
            const filtered = data.filter(item => item.name.toLowerCase().includes(query)).slice(0, 10);
            
            if (filtered.length === 0) {
                suggestionsContainer.style.display = 'none';
                return;
            }
            
            // ×™×¦×™×¨×ª HTML ×¢× data attributes
            suggestionsContainer.innerHTML = filtered.map((item, index) => `
                <div class="autocomplete-suggestion" data-type="${type}" data-name="${item.name}" data-id="${item.id}">
                    <div class="suggestion-name">${item.name}</div>
                    <div class="suggestion-id">${item.id}</div>
                    <div class="suggestion-details">${item.transactions || 0} ×¢×¡×§××•×ª | â‚ª${(item.totalAmount || 0).toLocaleString()}</div>
                </div>
            `).join('');
            
            // ×”×•×¡×¤×ª event listeners ×œ×›×œ ×”×¦×¢×”
            suggestionsContainer.querySelectorAll('.autocomplete-suggestion').forEach(suggestion => {
                suggestion.addEventListener('click', function() {
                    const type = this.getAttribute('data-type');
                    const name = this.getAttribute('data-name');
                    const id = this.getAttribute('data-id');
                    
                    if (type === 'payers') {
                        document.getElementById('payerName').value = name;
                        document.getElementById('payerID').value = id;
                    } else {
                        document.getElementById('customerName').value = name;
                        document.getElementById('customerID').value = id;
                    }
                    
                    hideSuggestions();
                });
            });
            
            suggestionsContainer.style.display = 'block';
        }

        function selectSuggestion(type, index) {
            const suggestionsId = type === 'payers' ? 'payerSuggestions' : 'customerSuggestions';
            const suggestionsContainer = document.getElementById(suggestionsId);
            const selectedItem = suggestionsContainer.filteredData[index];
            
            if (!selectedItem) return;
            
            if (type === 'payers') {
                document.getElementById('payerName').value = selectedItem.name;
                document.getElementById('payerID').value = selectedItem.id;
                console.log('× ×‘×—×¨ ××•×©×š:', selectedItem.name, selectedItem.id);
            } else {
                document.getElementById('customerName').value = selectedItem.name;
                document.getElementById('customerID').value = selectedItem.id;
                console.log('× ×‘×—×¨ ×œ×§×•×—:', selectedItem.name, selectedItem.id);
            }
            
            hideSuggestions();
        }

        function hideSuggestions() {
            document.getElementById('payerSuggestions').style.display = 'none';
            document.getElementById('customerSuggestions').style.display = 'none';
        }

        function refreshAutocomplete() {
            console.log(`AutoComplete ××¢×•×“×›×Ÿ: ${payersData.length} ××•×©×›×™×, ${customersData.length} ×œ×§×•×—×•×ª`);
        }

        function calculateRating() {
            const payerName = document.getElementById('payerName').value;
            const payerID = document.getElementById('payerID').value;
            const customerName = document.getElementById('customerName').value;
            const customerID = document.getElementById('customerID').value;
            const checkAmount = parseFloat(document.getElementById('checkAmount').value);

            if (!payerName || !customerName || !checkAmount) {
                alert('×× × ××œ× ××ª ×”×©×“×•×ª ×”×—×•×‘×”: ×©× ××•×©×š, ×©× ×œ×§×•×— ×•×¡×›×•× ×”×©×™×§');
                return;
            }

            // ×—×™×¤×•×© × ×ª×•× ×™× ×××™×ª×™×™×
            const payerData = findEntityData(payerID || payerName, payersData);
            const customerData = findEntityData(customerID || customerName, customersData);

            // ×—×™×©×•×‘ ×™××™ ××©×¨××™
            const today = new Date();
            const payment = document.getElementById('paymentDate').value ? 
                new Date(document.getElementById('paymentDate').value) : 
                new Date(today.getTime() + 46*24*60*60*1000);
            const creditDays = Math.ceil((payment - today) / (1000 * 60 * 60 * 24));

            // ×—×™×¤×•×© × ×ª×•× ×™ D&B
            const dbRecord = findDBRecord(payerID);

            // ×—×™×©×•×‘ ×¤×¨××˜×¨×™× ××ª×§×“× ×™×•×ª×¨
            const parameters = calculateAdvancedParameters(payerData, customerData, dbRecord, checkAmount, creditDays);

            // ×—×™×©×•×‘ ×¦×™×•×Ÿ ×¡×•×¤×™
            let finalScore = 0;
            parameters.forEach(param => {
                finalScore += (param.normalizedValue * param.weight) / 100;
            });
            finalScore = Math.max(0, Math.min(100, finalScore * 100));

            const rating = getRatingFromScore(finalScore);
            const { recommendation, recommendationClass } = getRecommendation(finalScore);

            // ×”×¦×’×ª ×ª×•×¦××•×ª ××¤×•×¨×˜×•×ª
            displayAdvancedResults({
                payerName, customerName, payerID, customerID, checkAmount, creditDays,
                finalScore, rating, recommendation, recommendationClass, parameters, 
                payerData, customerData, dbRecord,
                isRealData: transactionsData.length > 0
            });
        }

        function findEntityData(identifier, dataArray) {
            if (!identifier) return dataArray[0] || {};
            
            return dataArray.find(item => 
                item.id === identifier || 
                item.name === identifier ||
                item.name.includes(identifier)
            ) || dataArray[0] || {};
        }

        function findDBRecord(payerID) {
            if (!payerID || dbData.length === 0) return {};
            
            return dbData.find(record => 
                record['××¡\' ×—.×¤'] === payerID ||
                record['××¡×¤×¨_×–×”×•×ª'] === payerID ||
                record['id'] === payerID
            ) || {};
        }

        function calculateAdvancedParameters(payerData, customerData, dbRecord, checkAmount, creditDays) {
            // × ×ª×•× ×™× ××”×§×‘×¦×™× ×”×××™×ª×™×™× ××• ×‘×¨×™×¨×•×ª ××—×“×œ
            const dbScore = parseFloat(dbRecord['×¡×§×•×¨'] || dbRecord['score']) || payerData.dbScore || 38.704;
            const sectorScore = parseFloat(dbRecord['×¡×§×•×¨ ×¢× ×£'] || dbRecord['sector_score']) || payerData.sectorScore || 29;
            const companyAge = parseInt(dbRecord['×©× ×•×ª ×•×ª×§'] || dbRecord['years']) || payerData.companyAge || 0;
            const employeeCount = parseInt(dbRecord['××¡\' ××•×¢×¡×§×™×'] || dbRecord['employees']) || payerData.employeeCount || 0;
            const annualTurnover = parseFloat(dbRecord['××—×–×•×¨ ×‘×\' â‚ª'] || dbRecord['turnover']) || payerData.annualTurnover || 0;

            // ×—×™×©×•×‘ ×—×–×¨×•×ª ×©×™×§×™× ×× ×ª×•× ×™× ×××™×ª×™×™×
            const returnedChecks = calculateReturnedChecks(payerData.id);

            return [
                {
                    name: '××¡×¤×¨ ×¢×¡×§××•×ª ×§×•×“××•×ª',
                    weight: 15,
                    rawValue: payerData.transactions || 0,
                    normalizedValue: calculateTransactionsScore(payerData.transactions || 0),
                    reason: getTransactionsReason(payerData.transactions || 0),
                    status: getTransactionsStatus(payerData.transactions || 0)
                },
                {
                    name: '××¡×¤×¨ ×—×–×¨×•×ª ×©×™×§×™×',
                    weight: 5,
                    rawValue: returnedChecks,
                    normalizedValue: calculateReturnedChecksScore(returnedChecks),
                    reason: getReturnedChecksReason(returnedChecks),
                    status: getReturnedChecksStatus(returnedChecks)
                },
                {
                    name: '×—×¨×™×’×” ××××•×¦×¢ ×™××™ ××©×¨××™',
                    weight: 10,
                    rawValue: creditDays,
                    normalizedValue: calculateCreditDaysScore(creditDays),
                    reason: getCreditDaysReason(creditDays),
                    status: getCreditDaysStatus(creditDays)
                },
                {
                    name: '×“×™×¨×•×’ D&B',
                    weight: 8,
                    rawValue: dbScore,
                    normalizedValue: calculateDBScore(dbScore),
                    reason: getDBReason(dbScore),
                    status: getDBStatus(dbScore)
                },
                {
                    name: '×“×™×¨×•×’ ×¢× ×£',
                    weight: 5,
                    rawValue: sectorScore,
                    normalizedValue: calculateSectorScore(sectorScore),
                    reason: getSectorReason(sectorScore),
                    status: getSectorStatus(sectorScore)
                },
                {
                    name: '××¡×•×›× ×ª ××”×¢× ×£',
                    weight: 8,
                    rawValue: dbScore - sectorScore,
                    normalizedValue: calculateSectorRiskScore(dbScore, sectorScore),
                    reason: getSectorRiskReason(dbScore, sectorScore),
                    status: getSectorRiskStatus(dbScore, sectorScore)
                },
                {
                    name: '×’×™×œ ×”×—×‘×¨×”',
                    weight: 13,
                    rawValue: companyAge,
                    normalizedValue: calculateCompanyAgeScore(companyAge),
                    reason: getCompanyAgeReason(companyAge),
                    status: getCompanyAgeStatus(companyAge)
                },
                {
                    name: '××—×–×•×¨ ×©× ×ª×™',
                    weight: 3,
                    rawValue: annualTurnover,
                    normalizedValue: calculateTurnoverScore(annualTurnover),
                    reason: getTurnoverReason(annualTurnover),
                    status: getTurnoverStatus(annualTurnover)
                }
            ];
        }

        // ×¤×•× ×§×¦×™×•×ª ×—×™×©×•×‘ (×›××• ×‘×’×¨×¡×” ×”×§×•×“××ª)
        function calculateTransactionsScore(count) {
            if (count >= 100) return 1;
            if (count >= 50) return 0.8;
            if (count >= 20) return 0.6;
            if (count >= 10) return 0.4;
            if (count >= 5) return 0.2;
            return count === 0 ? 0 : 0.1;
        }

        function calculateReturnedChecksScore(count) {
            return count === 0 ? 1 : Math.max(0, 1 - count * 0.2);
        }

        function calculateCreditDaysScore(days) {
            return days <= 30 ? 1 : Math.max(0, 1 - (days - 30) / 60);
        }

        function calculateDBScore(score) {
            return score >= 30 ? score / 100 : Math.max(0, (score / 100) - 0.3);
        }

        function calculateSectorScore(score) {
            return score >= 32 ? score / 100 : Math.max(0, (score / 100) - 0.3);
        }

        function calculateSectorRiskScore(dbScore, sectorScore) {
            return dbScore >= sectorScore ? 0 : Math.min(0, (dbScore - sectorScore) / 50) * 10;
        }

        function calculateCompanyAgeScore(age) {
            if (age >= 30) return 1;
            if (age >= 20) return 0.8;
            if (age >= 10) return 0.6;
            if (age >= 5) return 0.4;
            if (age >= 3) return 0.2;
            return 0.1;
        }

        function calculateTurnoverScore(turnover) {
            return Math.min(turnover / 50000000, 1);
        }

        function calculateReturnedChecks(payerID) {
            if (returnedChecksData.length === 0) return 0;
            return returnedChecksData.filter(check => 
                check['××¡×¤×¨ ××–×”×” ××•×©×š'] === payerID ||
                check['payer_id'] === payerID
            ).length;
        }

        // ×¤×•× ×§×¦×™×•×ª ×¡×™×‘×•×ª ×•×”×¡×‘×¨×™×
        function getTransactionsReason(count) {
            if (count === 0) return '××™×Ÿ ×¢×¡×§××•×ª ×§×•×“××•×ª - ××•×©×š ×—×“×©';
            if (count >= 50) return `${count} ×¢×¡×§××•×ª - ××•×©×š ×× ×•×¡×” ×××•×“`;
            if (count >= 20) return `${count} ×¢×¡×§××•×ª - ××•×©×š ×× ×•×¡×”`;
            if (count >= 10) return `${count} ×¢×¡×§××•×ª - ××•×©×š ×¤×¢×™×œ`;
            return `${count} ×¢×¡×§××•×ª - ××•×©×š ×—×“×© ×™×—×¡×™×ª`;
        }

        function getReturnedChecksReason(count) {
            if (count === 0) return '××™×Ÿ ×—×–×¨×•×ª ×©×™×§×™× - × ×§×™ ×œ×—×œ×•×˜×™×Ÿ';
            if (count <= 2) return `${count} ×—×–×¨×•×ª - ×¢×“×™×™×Ÿ ×‘×¡×“×¨`;
            if (count <= 5) return `${count} ×—×–×¨×•×ª - ××¢×˜ ×‘×¢×™×™×ª×™`;
            return `${count} ×—×–×¨×•×ª ×©×™×§×™× - ×‘×¢×™×™×ª×™ ×××•×“`;
        }

        function getCreditDaysReason(days) {
            if (days <= 30) return '×™××™ ××©×¨××™ ×ª×§×™× ×™×';
            if (days <= 45) return '×™××™ ××©×¨××™ ××¢×˜ ×’×‘×•×”×™×';
            if (days <= 60) return '×™××™ ××©×¨××™ ×’×‘×•×”×™× ××”×××•×¦×¢';
            return '×™××™ ××©×¨××™ ×’×‘×•×”×™× ×××•×“ - ×ª× ××™ ××©×¨××™ ×§×©×™×';
        }

        function getDBReason(score) {
            if (score <= 20) return '×¦×™×•×Ÿ D&B × ××•×š ×××•×“ - BADâŒ';
            if (score <= 30) return '×¦×™×•×Ÿ D&B × ××•×š - NOâ˜¢ï¸';
            if (score <= 50) return '×¦×™×•×Ÿ D&B ×‘×™× ×•× ×™ - OKâœ…';
            if (score <= 75) return '×¦×™×•×Ÿ D&B ×˜×•×‘ - GOODğŸ˜Š';
            return '×¦×™×•×Ÿ D&B ××¢×•×œ×” - VERY GOODğŸ˜€';
        }

        function getSectorReason(score) { return '×“×™×¨×•×’ ×¢× ×£'; }
        function getSectorRiskReason(dbScore, sectorScore) {
            return dbScore < sectorScore ? '××¡×•×›× ×ª ××”×¢× ×£ ×©×œ×”' : '××“×•×¨×’×ª ×›××• ×”×¢× ×£ ××• ××¢×œ×™×•';
        }
        function getCompanyAgeReason(age) {
            if (age === 0) return '×—×‘×¨×” ×—×“×©×” - ×œ×”×–×”×¨';
            if (age >= 30) return '×—×‘×¨×” ×•×ª×™×§×”';
            if (age >= 10) return '×—×‘×¨×” ×‘×©×œ×”';
            return '×—×‘×¨×” ×¦×¢×™×¨×”';
        }
        function getTurnoverReason(turnover) {
            return turnover === 0 ? '××™×Ÿ × ×ª×•× ×™ ××—×–×•×¨×™×' : `××—×–×•×¨: â‚ª${turnover.toLocaleString()}`;
        }

        // ×¤×•× ×§×¦×™×•×ª ×¡×˜×˜×•×¡
        function getTransactionsStatus(count) { return count === 0 ? 'missing' : count >= 10 ? 'positive' : 'neutral'; }
        function getReturnedChecksStatus(count) { return count === 0 ? 'positive' : count <= 2 ? 'neutral' : 'negative'; }
        function getCreditDaysStatus(days) { return days <= 30 ? 'positive' : days <= 60 ? 'neutral' : 'negative'; }
        function getDBStatus(score) { return score <= 30 ? 'negative' : score >= 50 ? 'positive' : 'neutral'; }
        function getSectorStatus(score) { return score >= 40 ? 'positive' : score >= 30 ? 'neutral' : 'negative'; }
        function getSectorRiskStatus(dbScore, sectorScore) { return dbScore < sectorScore ? 'negative' : 'neutral'; }
        function getCompanyAgeStatus(age) { return age === 0 ? 'negative' : age >= 10 ? 'positive' : 'neutral'; }
        function getTurnoverStatus(turnover) { return turnover === 0 ? 'missing' : turnover >= 10000000 ? 'positive' : 'neutral'; }

        function getRatingFromScore(score) {
            if (score >= 90) return 'AAA';
            if (score >= 80) return 'AA';
            if (score >= 70) return 'A';
            if (score >= 60) return 'BBB';
            if (score >= 50) return 'BB';
            if (score >= 40) return 'B';
            if (score >= 30) return 'CCC';
            return 'D';
        }

        function getRecommendation(score) {
            if (score >= 70) return { recommendation: '××•××œ×¥', recommendationClass: 'positive' };
            if (score >= 50) return { recommendation: '×‘×‘×“×™×§×” × ×•×¡×¤×ª', recommendationClass: 'warning' };
            return { recommendation: '×œ× ××•××œ×¥', recommendationClass: '' };
        }

        function displayAdvancedResults(results) {
            document.getElementById('ratingDisplay').innerHTML = `
                <div class="rating-card">
                    <div class="rating-score rating-${results.rating}">${results.finalScore.toFixed(1)}</div>
                    <div>×¦×™×•×Ÿ ×¡×•×¤×™</div>
                </div>
                <div class="rating-card">
                    <div class="rating-score rating-${results.rating}">${results.rating}</div>
                    <div>×“×™×¨×•×’ ××©×¨××™</div>
                </div>
                <div class="rating-card">
                    <div style="font-size: 2em; margin-bottom: 10px;">ğŸ“Š</div>
                    <div>×¨××ª ×¡×™×›×•×Ÿ: ${results.finalScore >= 70 ? '× ××•×›×”' : results.finalScore >= 50 ? '×‘×™× ×•× ×™×ª' : '×’×‘×•×”×”'}</div>
                </div>
            `;

            document.getElementById('detailsGrid').innerHTML = `
                <div class="detail-card">
                    <h3>×¤×¨×˜×™ ×”×¢×¡×§×”</h3>
                    <div class="detail-row"><span class="detail-label">××•×©×š:</span><span class="detail-value">${results.payerName}</span></div>
                    <div class="detail-row"><span class="detail-label">×—.×¤. ××•×©×š:</span><span class="detail-value">${results.payerID}</span></div>
                    <div class="detail-row"><span class="detail-label">×œ×§×•×—:</span><span class="detail-value">${results.customerName}</span></div>
                    <div class="detail-row"><span class="detail-label">×—.×¤. ×œ×§×•×—:</span><span class="detail-value">${results.customerID}</span></div>
                    <div class="detail-row"><span class="detail-label">×¡×›×•×:</span><span class="detail-value">â‚ª${results.checkAmount.toLocaleString()}</span></div>
                    <div class="detail-row"><span class="detail-label">×™××™ ××©×¨××™:</span><span class="detail-value">${results.creditDays}</span></div>
                </div>
                <div class="detail-card">
                    <h3>× ×ª×•× ×™ ××•×©×š (${results.isRealData ? '×××™×ª×™×™×' : '×“×•×’××”'})</h3>
                    <div class="detail-row"><span class="detail-label">×¢×¡×§××•×ª ×§×•×“××•×ª:</span><span class="detail-value">${results.payerData.transactions || 0}</span></div>
                    <div class="detail-row"><span class="detail-label">×¡×›×•× ×›×•×œ×œ:</span><span class="detail-value">â‚ª${(results.payerData.totalAmount || 0).toLocaleString()}</span></div>
                    <div class="detail-row"><span class="detail-label">×¦×™×•×Ÿ D&B:</span><span class="detail-value">${results.payerData.dbScore || 38.704}</span></div>
                    <div class="detail-row"><span class="detail-label">×¦×™×•×Ÿ ×¢× ×£:</span><span class="detail-value">${results.payerData.sectorScore || 29}</span></div>
                    <div class="detail-row"><span class="detail-label">×’×™×œ ×—×‘×¨×”:</span><span class="detail-value">${results.payerData.companyAge || 0} ×©× ×™×</span></div>
                </div>
                <div class="detail-card">
                    <h3>× ×ª×•× ×™ ×œ×§×•×—</h3>
                    <div class="detail-row"><span class="detail-label">×¢×¡×§××•×ª ×§×•×“××•×ª:</span><span class="detail-value">${results.customerData.transactions || 0}</span></div>
                    <div class="detail-row"><span class="detail-label">×¡×›×•× ×›×•×œ×œ:</span><span class="detail-value">â‚ª${(results.customerData.totalAmount || 0).toLocaleString()}</span></div>
                    <div class="detail-row"><span class="detail-label">××¡×¤×¨ ×¢×•×‘×“×™×:</span><span class="detail-value">${results.dbRecord['××¡\' ××•×¢×¡×§×™×'] || results.payerData.employeeCount || '×œ× ×™×“×•×¢'}</span></div>
                    <div class="detail-row"><span class="detail-label">××—×–×•×¨ ×©× ×ª×™:</span><span class="detail-value">${results.dbRecord['××—×–×•×¨ ×‘×\' â‚ª'] ? 'â‚ª' + parseInt(results.dbRecord['××—×–×•×¨ ×‘×\' â‚ª']).toLocaleString() : '×œ× ×™×“×•×¢'}</span></div>
                    <div class="detail-row"><span class="detail-label">××§×•×¨ × ×ª×•× ×™×:</span><span class="detail-value">${results.isRealData ? '×§×‘×¦×™× ×××™×ª×™×™× âœ…' : '× ×ª×•× ×™ ×“×•×’××” âš ï¸'}</span></div>
                </div>
            `;

            let parametersHTML = `<div class="parameter-item" style="font-weight: bold; background: #f8f9fa;">
                <div>×¤×¨××˜×¨</div><div>××©×§×œ</div><div>×¢×¨×š ×’×•×œ××™</div><div>×¢×¨×š ×× ×•×¨××œ</div><div>×¡×˜×˜×•×¡</div></div>`;
            
            results.parameters.forEach(param => {
                parametersHTML += `<div class="parameter-item">
                    <div><div class="parameter-name">${param.name}</div><div class="parameter-reason">${param.reason}</div></div>
                    <div>${param.weight}%</div><div>${param.rawValue}</div><div>${param.normalizedValue.toFixed(3)}</div>
                    <div><span class="status-badge status-${param.status}">${param.status === 'positive' ? '×—×™×•×‘×™' : param.status === 'negative' ? '×©×œ×™×œ×™' : param.status === 'missing' ? '×—×¡×¨' : '× ×™×˜×¨×œ×™'}</span></div></div>`;
            });

            document.getElementById('parametersGrid').innerHTML = parametersHTML;

            document.getElementById('recommendation').className = `recommendation ${results.recommendationClass}`;
            document.getElementById('recommendation').innerHTML = `
                <div style="font-size: 1.5em; margin-bottom: 10px;">
                    ${results.recommendation === '××•××œ×¥' ? 'âœ…' : results.recommendation === '×‘×‘×“×™×§×” × ×•×¡×¤×ª' ? 'âš ï¸' : 'âŒ'}
                </div>
                <div>×”××œ×¦×” ×¡×•×¤×™×ª: ${results.recommendation}</div>
                ${results.finalScore < 30 ? '<div style="margin-top: 10px; font-size: 0.9em;">×¢×¡×§×” ×‘×¡×™×›×•×Ÿ ×’×‘×•×” - × ×“×¨×©×ª ×‘×“×™×§×” ××¢××™×§×”</div>' : ''}
                <div style="margin-top: 10px; font-size: 0.9em;">${results.isRealData ? 'âœ… ××‘×•×¡×¡ ×¢×œ × ×ª×•× ×™× ×××™×ª×™×™× ××”×§×‘×¦×™× ×©×œ×š' : 'âš ï¸ ××‘×•×¡×¡ ×¢×œ × ×ª×•× ×™ ×“×•×’××” - ×”×¢×œ×” ×§×‘×¦×™× ×œ×“×™×•×§ ××œ×'}</div>
            `;

            document.getElementById('resultsSection').style.display = 'block';
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }

        function resetForm() {
            ['payerName', 'payerID', 'customerName', 'customerID', 'checkAmount', 'paymentDate', 'bankCode', 'branchCode'].forEach(id => {
                document.getElementById(id).value = '';
            });
            document.getElementById('resultsSection').style.display = 'none';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function loadExample() {
            document.getElementById('payerName').value = '×”×“×¨ ×‘× ×™×” ××—×–×§×”';
            document.getElementById('payerID').value = '200353902';
            document.getElementById('customerName').value = '××™×‘×¨×”×™× ×¨××‘×™';
            document.getElementById('customerID').value = '305346900';
            document.getElementById('checkAmount').value = '50000';
            document.getElementById('bankCode').value = '20';
            document.getElementById('branchCode').value = '512';
            
            const futureDate = new Date();
            futureDate.setDate(futureDate.getDate() + 46);
            document.getElementById('paymentDate').value = futureDate.toISOString().split('T')[0];
        }

        window.addEventListener('load', initializeSystem);
    </script>
</body>
</html>
